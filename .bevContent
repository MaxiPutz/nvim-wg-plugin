{
  "files": [
    {
      "path": "README.md",
      "content": "# nvim-wg-plugin\n\nA lightweight Neovim plugin to manage **WireGuard servers directly inside Neovim**.\nInitialize a server, generate keys, create peers, update `wg0.conf`, and automatically copy client configurations to your clipboard\u00a0\u2014 all without leaving your editor.\n\nPerfect for sysadmins working over SSH, developers building VPN setups, or anyone maintaining WireGuard nodes.\n\n---\n\n## \u2728 Features\n\n### \ud83d\udd1e Server Initialization \u2014 `:WGInitServer`\n\nAutomatically creates a fully working WireGuard server config in the current directory:\n\n- `privatekey` \u2013 server private key  \n- `publickey`  \u2013 server public key  \n- `wg0.conf`   \u2013 default WireGuard configuration with:\n\n```ini\n[Interface]\nAddress = 10.0.0.1/24\nListenPort = 51820\nPrivateKey = <privatekey>\n\n# Forward von wg0 -> eth0 erlauben + Antworten zurÃ¼ck + NAT\nPostUp   = iptables -A FORWARD -i %i -o eth0 -j ACCEPT; iptables -A FORWARD -i eth0 -o %i -m conntrack --ctstate RELATED,ESTABLISHED -j ACCEPT; iptables -t nat -A POSTROUTING -o eth0 -j MASQUERADE\nPostDown = iptables -D FORWARD -i %i -o eth0 -j ACCEPT; iptables -D FORWARD -i eth0 -o %i -m conntrack --ctstate RELATED,ESTABLISHED -j ACCEPT; iptables -t nat -D POSTROUTING -o eth0 -j MASQUERADE\n```\n\n### \ud83e\udde9 Add New Peer \u2014 `:WGAddPeer`\n\nFor each new peer, the plugin:\n\n- Detects the next free client name (`client1`, `client2`, \u2026)\n- Detects the next available IP inside the WireGuard subnet (e.g. `10.0.0.2/32`, `10.0.0.3/32`, \u2026)\n- Creates a directory:\n\n```text\nclientN/\n  privatekey\n  publickey\n  wg0.conf\n```\n\n- Appends a new `[Peer]` block to the server `wg0.conf`\n- Copies the generated client config to your clipboard:\n  - via **OSC52** (terminal clipboard) if enabled\n  - otherwise into the `+` register (system clipboard)\n\n### \ud83d\udda5 Clipboard support\n\n- **OSC52** (terminal clipboard, ideal for SSH sessions)  \n- **`+` register** (default system clipboard)\n\n### \ud83d\udccf Auto-incrementing peers\n\n- Automatically finds the highest used peer IP and increments it.\n- Automatically finds the highest `clientN` directory and increments it.\n\n### \ud83e\uddf0 Minimal dependencies\n\n- Requires WireGuard tools: `wg`, `wg pubkey`\n- `ojroques/nvim-osc52` is optional (for OSC52 clipboard support)\n\n---\n\n## \ud83d\udce6 Installation (lazy.nvim)\n\n```lua\n{\n  \"MaxiPutz/nvim-wg-plugin\",\n  dependencies = {\n    \"ojroques/nvim-osc52\", -- optional, only needed if you want OSC52 clipboard\n  },\n  config = function()\n    require(\"nvim-wg-plugin\").setup({\n      -- If true: copy configs via OSC52 (for SSH/terminal)\n      -- If false or omitted: copy configs to the + register\n      osc52 = false,\n    })\n  end,\n}\n```\n\n---\n\n## \ud83d\ude80 Usage\n\n### 1. Initialize a WireGuard server\n\nIn the directory where you want your WireGuard config (e.g. `/etc/wireguard`):\n\n```vim\n:WGInitServer\n```\n\nThis creates:\n\n```text\nprivatekey\npublickey\nwg0.conf\n```\n\n`wg0.conf` will have a default `[Interface]` config with:\n\n- Address: `10.0.0.1/24`\n- ListenPort: `51820`\n- NAT + forwarding rules via iptables\n\n> **Note:** You may need to adjust `eth0` to match your real network interface (e.g. `ens3`, `enp1s0`, \u2026).\n\n---\n\n### 2. Add a new peer\n\nFrom the same directory (where `wg0.conf` lives):\n\n```vim\n:WGAddPeer\n```\n\nThis will:\n\n1. Scan existing peers / IPs in `wg0.conf`\n2. Determine the next free IP in the subnet (e.g. `10.0.0.2/32`, `10.0.0.3/32`, \u2026)\n3. Create a new folder:\n\n```text\nclient1/\nclient2/\nclient3/\n...\n```\n\n4. Inside the new folder, it creates:\n\n```text\nprivatekey\npublickey\nwg0.conf\n```\n\n5. Append a new `[Peer]` block to the server `wg0.conf`\n6. Copy the generated client configuration to your clipboard\n\nYou can then paste the client config directly into the WireGuard mobile or desktop app.\n\n---\n\n## \ud83d\uddc2 Directory Structure\n\nAfter initializing and adding some peers, your directory might look like this:\n\n```text\n.\nâ”œâ”€â”€ privatekey\nâ”œâ”€â”€ publickey\nâ”œâ”€â”€ wg0.conf\nâ”œâ”€â”€ client1\nâ”‚   â”œâ”€â”€ privatekey\nâ”‚   â”œâ”€â”€ publickey\nâ”‚   â””â”€â”€ wg0.conf\nâ”œâ”€â”€ client2\nâ”‚   â”œâ”€â”€ privatekey\nâ”‚   â”œâ”€â”€ publickey\nâ”‚   â””â”€â”€ wg0.conf\nâ””â”€â”€ ...\n```\n\nThe plugin always operates based on the **current working directory**.\nCheck with:\n\n```vim\n:pwd\n```\n\n---\n\n## \u2699\ufe0f Configuration Options\n\n`setup()` accepts a single (optional) table:\n\n```lua\nrequire(\"nvim-wg-plugin\").setup({\n  osc52 = false, -- default: use + register\n})\n```\n\n### Available options:\n\n| Option | Type | Default | Description |\n|--------|------|---------|-------------|\n| osc52  | bool | false   | If `true`, use OSC52 clipboard. Otherwise use the `+` register. |\n\nBehavior matrix:\n\n| Call                                | `use_osc52` |\n|-------------------------------------|-------------|\n| `setup()`                           | `false`     |\n| `setup({})`                         | `false`     |\n| `setup({ osc52 = false })`          | `false`     |\n| `setup({ osc52 = true })`           | `true`      |\n\n---\n\n## \ud83d\udcc4 Example Client Configuration\n\nA typical generated client configuration looks like this:\n\n```ini\n[Interface]\nPrivateKey = <client private key>\nAddress    = 10.0.0.X/32\nDNS        = 1.1.1.1\n\n[Peer]\nPublicKey  = <server public key>\nEndpoint   = your.server:51820\nAllowedIPs = 0.0.0.0/0, ::/0\nPersistentKeepalive = 25\n```\n\nYou can paste this directly into the WireGuard app on your phone or laptop.\n\n---\n\n## \ud83d\udca1 Tips\n\n### Show current working directory\n\n```vim\n:pwd\n```\n\n### Reload plugin (lazy.nvim)\n\n```vim\n:Lazy reload nvim-wg-plugin\n```\n\n### Show messages / errors\n\n```vim\n:messages\n```\n\n---\n\n## \ud83d\uddc7\ufe0f Roadmap / Ideas\n\nPlanned or possible future features:\n\n- [ ] `:WGDeletePeer` \u2014 safely remove a peer and clean `wg0.conf`\n- [ ] QR code output (for mobile import) using `qrencode`\n- [ ] Automatic `wg syncconf` execution after changes\n- [ ] Customizable server endpoint (prompt or config option)\n- [ ] Support for custom IP ranges and subnets\n- [ ] Telescope integration or a small UI for managing peers\n\n---\n\n## \ud83e\udd1d Contributing\n\nContributions, ideas, issues, and PRs are very welcome!\nIf you have improvements for UX, safety, or additional features, feel free to open an issue or a pull request.\n\n---\n\n## \u2b50 Support\n\nIf this plugin helps you manage WireGuard more efficiently, please consider giving it a \u2b50 on GitHub:\n\nðŸ‘‰ https://github.com/MaxiPutz/nvim-wg-plugin\n"
    }
  ]
}

